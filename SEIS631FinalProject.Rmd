---
title: "SEIS631 Final Project"
author: "Nikolai"
date: "5/4/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
personalityData <- read_csv("data.csv")

Convert_Negative_score <- function(x) {return (5-x)}
```

## Introduction
Personality has always been a fascination of mine. While many personality tests have little validity or predictive value, The Big Five personality tests have a reputation of being a good measure with predictive power. I have found a publicly available dataset of demographic information and personality data that I wish to analyze using techniques taught in class.


## What



## Why



## How



## Body

## Cleaning the data.
In order to account for the preference of a person to respond positively or negatively to questions, OCEAN tests usually have answers that mean similar things but phrased in a positive or negative manner. In order to compare these types of data, first I will have to convert these negative values to positive ones. I have created a function to do this, and using the codebook that came with the data I can determine which questions were negative or positive. I'm going to first look at extroversion versus introversion, clean the data, and plot it for US populations to see if there are any trends.

```{r, echo=FALSE}
PDClean <- personalityData
PDClean$E2 <- Convert_Negative_score(PDClean$E2)
PDClean$E4 <- Convert_Negative_score(PDClean$E4)
PDClean$E6 <- Convert_Negative_score(PDClean$E6)
PDClean$E8 <- Convert_Negative_score(PDClean$E8)
PDClean$E10 <- Convert_Negative_score(PDClean$E10)

PDClean$N2 <- Convert_Negative_score(PDClean$N2)
PDClean$N4 <- Convert_Negative_score(PDClean$N4)

PDClean$A1 <- Convert_Negative_score(PDClean$A1)
PDClean$A3 <- Convert_Negative_score(PDClean$A3)
PDClean$A5 <- Convert_Negative_score(PDClean$A5)
PDClean$A7 <- Convert_Negative_score(PDClean$A7)

PDClean$C2 <- Convert_Negative_score(PDClean$C2)
PDClean$C4 <- Convert_Negative_score(PDClean$C4)
PDClean$C6 <- Convert_Negative_score(PDClean$C6)
PDClean$C8 <- Convert_Negative_score(PDClean$C8)

PDClean$O2 <- Convert_Negative_score(PDClean$O2)
PDClean$O4 <- Convert_Negative_score(PDClean$O4)
PDClean$O6 <- Convert_Negative_score(PDClean$O6)

```


```{r, echo=FALSE}

PDClean$Extraversion <- with(PDClean, (E1+E2+E3+E4+E5+E6+E7+E8+E9+E10)/10)
PDClean$Neuroticism <- with(PDClean, 
                         (  N1+
                            N2+
                            N3+
                            N4+
                            N5+
                            N6+
                            N7+
                            N8+
                            N9+
                            N10)/10)
PDClean$Openness <- with(PDClean, 
                         (  O1+
                            O2+
                            O3+
                            O4+
                            O5+
                            O6+
                            O7+
                            O8+
                            O9+
                            O10)/10)

PDClean$Conscientiousness <- with(PDClean, 
                         (  C1+
                            C2+
                            C3+
                            C4+
                            C5+
                            C6+
                            C7+
                            C8+
                            C9+
                            C10)/10)

PDClean$Agreeableness <- with(PDClean, 
                         (  A1+
                            A2+
                            A3+
                            A4+
                            A5+
                            A6+
                            A7+
                            A8+
                            A9+
                            A10)/10)

USAvg <- subset.data.frame(PDClean, country == "US")

ggplot(USAvg, aes(x=age, y=Extraversion)) + geom_point(data = USAvg, mapping = aes(x=age, y=Extraversion), alpha=.1, color="red") + xlim(10, 100)

ggplot(USAvg, aes(x=age, y=Openness)) + geom_point(data = USAvg, mapping = aes(x=age, y=Openness), alpha=.1, color="blue") + xlim(10, 100)

ggplot(USAvg, aes(x=age, y=Conscientiousness)) + geom_point(data = USAvg, mapping = aes(x=age, y=Conscientiousness), alpha=.1, color="green") + xlim(10, 100)

ggplot(USAvg, aes(x=age, y=Neuroticism)) + geom_point(data = USAvg, mapping = aes(x=age, y=Neuroticism), alpha=.1, color="purple") + xlim(10, 100)

ggplot(USAvg, aes(x=age, y=Agreeableness)) + geom_point(data = USAvg, mapping = aes(x=age, y=Agreeableness), alpha=.1, color="orange") + xlim(10, 100)
```
If we take the averages of all of the question's scores for each trait for respondents in the US, we see that most respondents were age 25 or younger. We also see trends, such as Agreeableness and Openness tend to be higher than 2. Conscientiousness and Neuroticism seem to avoid the valences of 1 and 5.Extroversion, on the other hand, appears to be across the board.looking at the above graph of age versus extroversion, it seems there is little relation between age and being introverted or extroverted with the exception of after age 60 it appears like less people are strongly introverted. 

```{r, echo=FALSE}

CAAvg <- subset.data.frame(PDClean, country == "CA")

ggplot(CAAvg, aes(x=age, y=Extraversion)) + geom_point(data = CAAvg, mapping = aes(x=age, y=Extraversion), alpha=.1, color="red") + xlim(10, 100)

ggplot(CAAvg, aes(x=age, y=Openness)) + geom_point(data = CAAvg, mapping = aes(x=age, y=Openness), alpha=.1, color="blue") + xlim(10, 100)

ggplot(CAAvg, aes(x=age, y=Conscientiousness)) + geom_point(data = CAAvg, mapping = aes(x=age, y=Conscientiousness), alpha=.1, color="green") + xlim(10, 100)

ggplot(CAAvg, aes(x=age, y=Neuroticism)) + geom_point(data = CAAvg, mapping = aes(x=age, y=Neuroticism), alpha=.1, color="purple") + xlim(10, 100)

ggplot(CAAvg, aes(x=age, y=Agreeableness)) + geom_point(data = CAAvg, mapping = aes(x=age, y=Agreeableness), alpha=.1, color="orange") + xlim(10, 100)
```
```{r, echo=TRUE}

CountryCount <- PDClean %>% count(country)
View(CountryCount)
TopCountries <- subset.data.frame(CountryCount, CountryCount$n > 500)
View(TopCountries)
```

As seen by this R code, the top countries with observations in this dataset are English speaking countries. I will be looking at these countries next and similarities and differences within these countries to see if country, age, and sex result in significant differences. 


```{r, echo=FALSE}
TopPD <- subset.data.frame(PDClean, country == "US" | country == "AU" | country == "CA" | country == "GB" | country == "IN" | country == "PH")


ggplot(TopPD, aes(x=country, y=Extraversion)) + geom_point(data = TopPD, mapping = aes(x=country, y=Extraversion), alpha=.01, color="red")

ggplot(TopPD, aes(x=country, y=Openness)) + geom_point(data = TopPD, mapping = aes(x=country, y=Openness), alpha=.01, color="blue") 

ggplot(TopPD, aes(x=country, y=Conscientiousness)) + geom_point(data = TopPD, mapping = aes(x=country, y=Conscientiousness), alpha=.01, color="green")

ggplot(TopPD, aes(x=country, y=Neuroticism)) + geom_point(data = TopPD, mapping = aes(x=country, y=Neuroticism), alpha=.01, color="purple") 

ggplot(TopPD, aes(x=country, y=Agreeableness)) + geom_point(data = TopPD, mapping = aes(x=country, y=Agreeableness), alpha=.01, color="orange") 
```



## Topics From Class
(a) Git
(b) RMarkdown
(c) Statistical concepts such as normal distributions, mean, standard deviations, percentiles, and areas under the curve
(d) Geometric distributions
(e) T tests to determine if two populations are significantly different.

## Conclusion


